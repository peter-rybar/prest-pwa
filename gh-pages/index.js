!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("leaflet")):"function"==typeof define&&define.amd?define(["leaflet"],e):e(t.L)}(this,function(t){"use strict";function e(t,e){function o(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}function o(t,e,n){if(t){for(var i=t[0],r=t[1],s=r&&r.constructor===Object,a=s?2:1,c=0,u=a;u<t.length;u++)t[u]&&t[u].constructor!==Function&&c++;var p,l=i.split("~"),d=l[1],f=l[0].split("."),h=f[0].split("#"),m=h[0]||"div",g=h[1],y=f.slice(1);p=s?r:{},g&&(p._id=g),y.length&&(p._classes=y),d&&(p._ref=d);if(!e.open(m,p,c,n))for(var u=a,v=t.length;u<v;u++){var _=t[u];if(void 0!==_)switch(_.constructor){case Array:o(_,e,n);break;case Function:e.fnc(_,n);break;case String:e.text(_,n);break;default:e.obj(_,n)}}e.close(m,c,n)}}function n(t,e){o(t,new a,e)}function i(t,e){for(var o=0,i=t;o<i.length;o++){var r=i[o];if(r.constructor===String)IncrementalDOM.text(r);else if("toJsonML"in r){var s=r;n(s.toJsonML(),s)}else n(r,e)}}function r(t,e,o){IncrementalDOM.patch(t,function(t){return i(t,o)},e)}function s(t,e){self.Notification?(console.log("Notification supported"),Notification.requestPermission(function(o){"granted"===o?(console.log("Notification permission granted"),navigator.serviceWorker.ready.then(function(o){console.log("Notification SW ready"),o.showNotification(t,e)})):console.warn("Notification permission:",o)})):console.warn("Notification not supported")}var a=function(){function t(){}return t.prototype.open=function(t,e,o,n){var i=[],r=e._id,s=e._classes?e._classes:[],a=e._ref;for(var c in e)if(e.hasOwnProperty(c))switch(c){case"_id":case"_classes":case"_ref":case"_key":case"_skip":break;case"id":r=e[c];break;case"classes":s=s.concat(e[c]);break;case"class":s=s.concat(e[c].split(" "));break;case"data":for(var u in e[c])e[c].hasOwnProperty(u)&&(e[c][u].constructor===String?i.push("data-"+u,e[c][u]):i.push("data-"+u,JSON.stringify(e[c][u])));break;case"styles":i.push("style",e[c]);break;default:"function"==typeof e[c]?i.push("on"+c,e[c]):i.push(c,e[c])}return s.length&&i.unshift("class",s.join(" ")),r&&i.unshift("id",r),IncrementalDOM.elementOpen.apply(IncrementalDOM,[t,e._key||null,null].concat(i)),e._skip&&IncrementalDOM.skip(),n&&a&&(n.refs[a]=IncrementalDOM.currentElement()),!!e._skip},t.prototype.close=function(t,e,o){IncrementalDOM.elementClose(t)},t.prototype.text=function(t,e){IncrementalDOM.text(t)},t.prototype.fnc=function(t,e){t(IncrementalDOM.currentElement())},t.prototype.obj=function(t,e){"toJsonML"in t?o(t.toJsonML(),this,t):this.text(""+t,e)},t}(),c=function(){function t(e){void 0===e&&(e=""),this.type="Widget",this.id=this.type+"-"+t.__count++,this.refs={},e&&(this.type=e)}return t.prototype.mount=function(t){if(void 0===t&&(t=document.body),!this.dom){this.dom=t;r(t,this.render(),this),t.setAttribute("widget",this.type),this.onMount&&this.onMount()}return this},t.prototype.umount=function(){return this.dom&&(this.onUmount&&this.onUmount(),this.dom.hasAttribute("widget")&&this.dom.removeAttribute("widget"),this.dom.parentElement.removeChild(this.dom),this.dom=void 0),this},t.prototype.update=function(){var t=this;return this.dom&&!this._updateSched&&(this._updateSched=setTimeout(function(){t.dom&&r(t.dom,t.render(),t),t._updateSched=null},0)),this},t.prototype.toJsonML=function(){var t=this;if(this.dom){if(!this._updateSched)return["div",{_skip:!0,_id:this.id,_key:this.id,widget:this.type}];clearTimeout(this._updateSched),this._updateSched=null}var e=this.render();return["div",{_id:this.id,_key:this.id,widget:this.type}].concat(e,[function(e){t.dom||(t.dom=e,t.onMount&&t.onMount())}])},t}();c.__count=0;var u=function(o){function n(){var e=o.call(this,"MapWidget")||this;return e._imagePath="/lib/leaflet/images/",e.onLocationFound=function(o){var n=o.accuracy/2;t.marker(o.latlng).addTo(e._map).bindPopup("<strong>Me</strong>, radius "+n+"m").openPopup(),t.circle(o.latlng,n).addTo(e._map)},e.onLocationError=function(t){alert(t.message)},e}return e(n,o),n.prototype.onMount=function(){var t=this;setTimeout(function(){return t._render(t.refs.map)},0)},n.prototype.render=function(){return[["div~map",{_skip:!!this._map,style:"width: 100%; height: 100%"}]]},n.prototype._render=function(e){this._imagePath&&(t.Icon.Default.imagePath=this._imagePath);var o=t.map(e).fitWorld();this._map=o,t.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw",{maxZoom:18,attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',id:"mapbox.streets"}).addTo(o),o.on("locationfound",this.onLocationFound),o.on("locationerror",this.onLocationError),o.locate({setView:!0,maxZoom:16})},n}(c);!function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then(function(t){t.installing?console.log("Service worker installing"):t.waiting?console.log("Service worker installed"):t.active&&console.log("Service worker active"),console.log("Registration succeeded. Scope is "+t.scope)}).catch(function(t){console.error("Registration failed with "+t)})}();var p=new u;p.mount(),setTimeout(function(){s("Notif title",{body:"Notif body",icon:"assets/icons/ic-face.png",tag:"notif-tag"})},3e3),self.app=p,self.VERSION="0.0.0"});
//# sourceMappingURL=index.js.map
