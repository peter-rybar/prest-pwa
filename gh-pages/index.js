!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){"use strict";function t(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function e(t,n,i){if(t){for(var o=t[0],s=t[1],r=s&&s.constructor===Object,a=r?2:1,c=0,l=a;l<t.length;l++)t[l]&&t[l].constructor!==Function&&c++;var u,p=o.split("~"),d=p[1],h=p[0].split("."),f=h[0].split("#"),m=f[0]||"div",g=f[1],_=h.slice(1);u=r?s:{},g&&(u._id=g),_.length&&(u._classes=_),d&&(u._ref=d);if(!n.open(m,u,c,i))for(var l=a,y=t.length;l<y;l++){var v=t[l];if(void 0!==v)switch(v.constructor){case Array:e(v,n,i);break;case Function:n.fnc(v,i);break;case String:n.text(v,i);break;default:n.obj(v,i)}}n.close(m,c,i)}}function n(t,n){e(t,new r,n)}function i(t,e){for(var i=0,o=t;i<o.length;i++){var s=o[i];if(s.constructor===String)IncrementalDOM.text(s);else if("toJsonML"in s){var r=s;n(r.toJsonML(),r)}else n(s,e)}}function o(t,e,n){IncrementalDOM.patch(t,function(t){return i(t,n)},e)}function s(t,e){self.Notification?(console.log("Notification supported"),Notification.requestPermission(function(n){"granted"===n?(console.log("Notification permission granted"),navigator.serviceWorker.ready.then(function(n){console.log("Notification SW ready"),n.showNotification(t,e)})):console.warn("Notification permission:",n)})):console.warn("Notification not supported")}var r=function(){function t(){}return t.prototype.open=function(t,e,n,i){var o=[],s=e._id,r=e._classes?e._classes:[],a=e._ref;for(var c in e)if(e.hasOwnProperty(c))switch(c){case"_id":case"_classes":case"_ref":case"_key":case"_skip":break;case"id":s=e[c];break;case"classes":r=r.concat(e[c]);break;case"class":r=r.concat(e[c].split(" "));break;case"data":for(var l in e[c])e[c].hasOwnProperty(l)&&(e[c][l].constructor===String?o.push("data-"+l,e[c][l]):o.push("data-"+l,JSON.stringify(e[c][l])));break;case"styles":o.push("style",e[c]);break;default:"function"==typeof e[c]?o.push("on"+c,e[c]):o.push(c,e[c])}return r.length&&o.unshift("class",r.join(" ")),s&&o.unshift("id",s),IncrementalDOM.elementOpen.apply(IncrementalDOM,[t,e._key||null,null].concat(o)),e._skip&&IncrementalDOM.skip(),i&&a&&(i.refs[a]=IncrementalDOM.currentElement()),!!e._skip},t.prototype.close=function(t,e,n){IncrementalDOM.elementClose(t)},t.prototype.text=function(t,e){IncrementalDOM.text(t)},t.prototype.fnc=function(t,e){t(IncrementalDOM.currentElement())},t.prototype.obj=function(t,n){"toJsonML"in t?e(t.toJsonML(),this,t):this.text(""+t,n)},t}(),a=function(){function t(e){void 0===e&&(e=""),this.type="Widget",this.id=this.type+"-"+t.__count++,this.refs={},e&&(this.type=e)}return t.prototype.mount=function(t){if(void 0===t&&(t=document.body),!this.dom){this.dom=t;o(t,this.render(),this),t.setAttribute("widget",this.type),this.onMount&&this.onMount()}return this},t.prototype.umount=function(){return this.dom&&(this.onUmount&&this.onUmount(),this.dom.hasAttribute("widget")&&this.dom.removeAttribute("widget"),this.dom.parentElement.removeChild(this.dom),this.dom=void 0),this},t.prototype.update=function(){var t=this;return this.dom&&!this._updateSched&&(this._updateSched=setTimeout(function(){t.dom&&o(t.dom,t.render(),t),t._updateSched=null},0)),this},t.prototype.toJsonML=function(){var t=this;if(this.dom){if(!this._updateSched)return["div",{_skip:!0,_id:this.id,_key:this.id,widget:this.type}];clearTimeout(this._updateSched),this._updateSched=null}var e=this.render();return["div",{_id:this.id,_key:this.id,widget:this.type}].concat(e,[function(e){t.dom||(t.dom=e,t.onMount&&t.onMount())}])},t}();a.__count=0;var c=function(){function t(){this._slots=[],this._emit=!0}return t.prototype.onConnect=function(t){this._onConnect=t},t.prototype.onDisconnect=function(t){this._onDisconnect=t},t.prototype.connNo=function(){return this._slots.length},t.prototype.connect=function(t,e){"function"==typeof t&&(e?this._slots.push({callback:t,object:e}):this._slots.push({callback:t}),this._onConnect&&this._onConnect(this._slots.length))},t.prototype.disconnect=function(t,e){"function"==typeof t&&(this._slots=this._slots.filter(function(n){return void 0===e?n.callback!==t:n.callback!==t&&n.object!==e}),this._onDisconnect&&this._onDisconnect(this._slots.length))},t.prototype.disconnectAll=function(){this._slots=[],this._onDisconnect&&this._onDisconnect(this._slots.length)},t.prototype.freeze=function(){this._emit=!1},t.prototype.unfreeze=function(){this._emit=!0},t.prototype.emit=function(t){return this._emit&&this._slots.length?this._slots.map(function(e){var n=e.object;return n?e.callback.call(n,t):e.callback(t)}):[]},t}(),l=function(e){function n(t){var n=e.call(this,"HelloWidget")||this;return n._onTextInput=function(t){var e=t.target;n._name=e.value,n.update()},n._name=t,n}return t(n,e),n.prototype.setName=function(t){return this._name=t,this.update(),this},n.prototype.onMount=function(){console.log("onMount",this.type,this.id),mdc.textField.MDCTextField.attachTo(this.refs.f)},n.prototype.onUmount=function(){console.log("onUmount",this.type,this.id)},n.prototype.render=function(){return[["h2.mdc-typography--title",this.type],["label.mdc-text-field~f",["input.mdc-text-field__input~i",{id:this.id+"-i",type:"text",value:this._name,input:this._onTextInput}],["span.mdc-text-field__label","Name"],["div.mdc-text-field__bottom-line"]],["p.mdc-typography--headline","Hello ",["strong",this._name]," !"]]},n}(a),u=function(e){function n(){return e.call(this,"TimerWidget")||this}return t(n,e),n.prototype.toggle=function(t){var e=this;switch(t){case!0:this._interval||(this._interval=setInterval(function(){return e.update()},1e3));break;case!1:this._interval&&(clearInterval(this._interval),this._interval=void 0);break;default:this.toggle(!this._interval)}this.update()},n.prototype.onMount=function(){console.log("onMount",this.type,this.id),mdc.ripple.MDCRipple.attachTo(this.refs.b),this.toggle(!0)},n.prototype.onUmount=function(){console.log("onUmount",this.type,this.id),this.toggle(!1)},n.prototype.render=function(){var t=this;return[["h2.mdc-typography--title",this.type],["p.mdc-typography--headline","Time: ",["strong",{style:this._interval?"":"color: lightgray;"},(new Date).toLocaleTimeString()]," ",["button.mdc-button.mdc-button--raised.mdc-ripple-surface~b",{click:function(e){return t.toggle()}},this._interval?"Stop":"Start"]]]},n}(a),p=function(e){function n(){var t=e.call(this,"FormWidget")||this;return t._title="Form",t._data={name:void 0,age:void 0},t._errors={name:"",age:""},t.sigData=new c,t._onFormSubmit=function(e){e.preventDefault(),console.log("submit",t._data),t.refs.submit.focus(),t._validateName(t.refs.name.value),t._validateAge(t.refs.age.value),t._errors.name||t._errors.age?t.update():(t.sigData.emit(t._data),t.refs.data.innerText=JSON.stringify(t._data,null,4))},t._onNameInput=function(e){var n=e.target;console.log("name",n.value),t._validateName(n.value),t.update()},t._onAgeInput=function(e){var n=e.target;console.log("age",n.value),t._validateAge(n.value),t.update()},t}return t(n,e),n.prototype.getTitle=function(){return this._title},n.prototype.setTitle=function(t){return this._title=t,this.update(),this},n.prototype.getData=function(){return this._data},n.prototype.setData=function(t){return this._data=t,this.update(),this},n.prototype.onMount=function(){console.log("onMount",this.type,this.id),mdc.textField.MDCTextField.attachTo(this.refs["f-name"]),mdc.textField.MDCTextField.attachTo(this.refs["f-age"])},n.prototype.onUmount=function(){console.log("onUmount",this.type,this.id)},n.prototype.render=function(){return[["h2.mdc-typography--title",this.type," ",["span.mdc-typography--caption.mdc-typography--adjust-margin",this._title]],["form",{action:"#",submit:this._onFormSubmit},["div",["label.mdc-text-field~f-name",["input.mdc-text-field__input~name",{type:"text",required:"",pattern:".{3,10}",size:10,maxlength:10,"aria-controls":"name-helptext",autocomplete:"name",input:this._onNameInput}],["span.mdc-text-field__label","Name"],["div.mdc-text-field__bottom-line"]],["p#name-helptext",{classes:["mdc-text-field-helptext","mdc-text-field-helptext--persistent-","mdc-text-field-helptext--validation-msg"],"aria-hidden":"true"},"Min 3, max 10 characters",["br"],this._errors.name]],["div",["label.mdc-text-field~f-age",["input.mdc-text-field__input~age",{type:"number",required:"",min:"1",max:"120","aria-controls":"age-helptext",autocomplete:"age",input:this._onAgeInput}],["span.mdc-text-field__label","age"],["div.mdc-text-field__bottom-line"]],["p#age-helptext",{classes:["mdc-text-field-helptext","mdc-text-field-helptext--persistent-","mdc-text-field-helptext--validation-msg"],"aria-hidden":"true"},"Min 1, max 120 years",["br"],this._errors.age]],["button.mdc-button.mdc-button--raised.mdc-ripple-surface~submit",{type:"submit"},"Submit"]],["pre~data"]]},n.prototype._validateName=function(t){t?(this._data.name=t,this._errors.name=""):(this._data.name=void 0,this._errors.name="Name required")},n.prototype._validateAge=function(t){t?isNaN(+t)?(this._data.age=void 0,this._errors.age="Invalid age number"):(this._data.age=+t,this._errors.age=""):(this._data.age=void 0,this._errors.age="Age required")},n}(a),d=function(e){function n(){var t=e.call(this,"AppWidget")||this;return t._title="App",t.helloWidget=new l("peter"),t.timerWidget=new u,t.formWidget=new p,t.formWidget.sigData.connect(function(t){return console.log("sig data",t)}),t}return t(n,e),n.prototype.setTitle=function(t){return this._title=t,this.update(),this},n.prototype.onMount=function(){console.log("onMount",this.type,this.id)},n.prototype.onUmount=function(){console.log("onUmount",this.type,this.id)},n.prototype.render=function(){return[["h1.mdc-typography--display1",this._title],this.helloWidget,["hr"],this.timerWidget,["hr"],this.formWidget]},n}(a);!function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then(function(t){t.installing?console.log("Service worker installing"):t.waiting?console.log("Service worker installed"):t.active&&console.log("Service worker active"),console.log("Registration succeeded. Scope is "+t.scope)}).catch(function(t){console.error("Registration failed with "+t)})}();var h=new d;h.setTitle("MyApp"),h.helloWidget.setName("Peter"),h.formWidget.setTitle("MyForm"),h.mount(document.getElementById("app")),setTimeout(function(){s("Notif title",{body:"Notif body",icon:"assets/icons/ic-face.png",tag:"notif-tag"})},3e5),self.app=h,self.VERSION="0.0.0"});
//# sourceMappingURL=index.js.map
