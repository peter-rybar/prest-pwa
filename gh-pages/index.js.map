{"version":3,"file":null,"sources":["../src/main/prest/jsonml/jsonml.ts","../src/main/prest/jsonml/jsonml-idom.ts","../src/main/sw-lib.ts","../src/main/prest/jsonml/jsonml-widget.ts","../src/main/index.ts"],"sourcesContent":["\nexport interface Attrs {\n    _id?: string;\n    _classes?: string[];\n    _ref?: string;\n    _key?: string;\n    _skip?: boolean;\n    data?: {[key: string]: any};\n    styles?: {[key: string]: string};\n    classes?: string[];\n    [key: string]: any;\n}\n\nexport type JsonMLFnc = (e?: HTMLElement) => void;\n\nexport interface JsonMLObj {\n    toJsonML?(): JsonML;\n}\n\nexport interface JsonML extends Array<string | Attrs | JsonML | JsonMLFnc | JsonMLObj> {\n    // 0: string;\n    // 1?: Attrs | JsonML | JsonMLFnc | JsonMObj;\n}\n\nexport interface JsonMLs extends Array<JsonML | string | JsonMLObj> {\n}\n\n\nexport interface JsonMLHandler {\n    open(tag: string, attrs: Attrs, children: number, ctx?: any): boolean;\n    close(tag: string, children: number, ctx?: any): void;\n    text(text: string, ctx?: any): void;\n    fnc(fnc: JsonMLFnc, ctx?: any): void;\n    obj(obj: JsonMLObj, ctx?: any): void;\n}\n\nexport function jsonml(jsonML: JsonML, handler: JsonMLHandler, ctx?: any): void {\n    if (!jsonML) {\n        return;\n    }\n\n    const head = jsonML[0] as string;\n    const attrsObj = jsonML[1] as any;\n    const hasAttrs = attrsObj && attrsObj.constructor === Object;\n    const childIdx = hasAttrs ? 2 : 1;\n\n    let children = 0;\n    for (let i = childIdx; i < jsonML.length; i++) {\n        if (jsonML[i] && jsonML[i].constructor !== Function) {\n            children++;\n        }\n    }\n\n    const refSplit = head.split(\"~\");\n    const ref = refSplit[1];\n    const dotSplit = refSplit[0].split(\".\");\n    const hashSplit = dotSplit[0].split(\"#\");\n    const tag = hashSplit[0] || \"div\";\n    const id = hashSplit[1];\n    const classes = dotSplit.slice(1);\n\n    let attrs: Attrs;\n    if (hasAttrs) {\n        attrs = attrsObj as Attrs;\n    } else {\n        attrs = {};\n    }\n\n    if (id) {\n        attrs._id = id;\n    }\n    if (classes.length) {\n        attrs._classes = classes;\n    }\n    if (ref) {\n        attrs._ref = ref;\n    }\n\n    const skip = handler.open(tag, attrs, children, ctx);\n\n    if (!skip) {\n        for (let i = childIdx, l = jsonML.length; i < l; i++) {\n            const jml = jsonML[i] as any;\n            if (jml === undefined) {\n                continue;\n            }\n            switch (jml.constructor) {\n                case Array:\n                    jsonml(jml, handler, ctx);\n                    break;\n                case Function:\n                    handler.fnc(jml, ctx);\n                    break;\n                case String:\n                    handler.text(jml, ctx);\n                    break;\n                default:\n                    handler.obj(jml, ctx);\n            }\n        }\n    }\n\n    handler.close(tag, children, ctx);\n}\n","\nimport {\n    JsonML,\n    JsonMLs,\n    JsonMLObj,\n    JsonMLFnc,\n    Attrs,\n    JsonMLHandler,\n    jsonml\n} from \"./jsonml\";\n\n\ndeclare var IncrementalDOM: any;\n\n\nclass JsonmlIDomHandler implements JsonMLHandler {\n\n    open(tag: string, attrs: Attrs, children: number, ctx?: any): boolean {\n        const props: any = [];\n        let id: string = attrs._id;\n        let classes: string[] = attrs._classes ? attrs._classes : [];\n        let ref: string = attrs._ref;\n        for (const a in attrs) {\n            if (attrs.hasOwnProperty(a)) {\n                switch (a) {\n                    case \"_id\":\n                    case \"_classes\":\n                    case \"_ref\":\n                    case \"_key\":\n                    case \"_skip\":\n                        break;\n                    case \"id\":\n                        id = attrs[a];\n                        break;\n                    case \"classes\":\n                        classes = classes.concat(attrs[a]);\n                        break;\n                    case \"class\":\n                        classes = classes.concat(attrs[a].split(\" \"));\n                        break;\n                    case \"data\":\n                        for (const d in attrs[a]) {\n                            if (attrs[a].hasOwnProperty(d)) {\n                                if (attrs[a][d].constructor === String) {\n                                    props.push(\"data-\" + d, attrs[a][d]);\n                                } else {\n                                    props.push(\"data-\" + d, JSON.stringify(attrs[a][d]));\n                                }\n                            }\n                        }\n                        break;\n                    case \"styles\":\n                        props.push(\"style\", attrs[a]);\n                        break;\n                    default:\n                        if (typeof attrs[a] === \"function\") {\n                            props.push(\"on\" + a, attrs[a]);\n                        } else {\n                            props.push(a, attrs[a]);\n                        }\n                }\n            }\n        }\n        if (classes.length) {\n            props.unshift(\"class\", classes.join(\" \"));\n        }\n        if (id) {\n            props.unshift(\"id\", id);\n        }\n        IncrementalDOM.elementOpen(tag, attrs._key || null, null, ...props);\n        if (attrs._skip) {\n            IncrementalDOM.skip();\n        }\n        if (ctx && ref) {\n            ctx.refs[ref] = IncrementalDOM.currentElement();\n        }\n        return attrs._skip ? true : false;\n    }\n\n    close(tag: string, children: number, ctx?: any): void {\n        IncrementalDOM.elementClose(tag);\n    }\n\n    text(text: string, ctx?: any): void {\n        IncrementalDOM.text(text);\n    }\n\n    fnc(fnc: JsonMLFnc, ctx?: any): void {\n        fnc(IncrementalDOM.currentElement());\n    }\n\n    obj(obj: JsonMLObj, ctx?: any): void {\n        if (\"toJsonML\" in obj) {\n            jsonml(obj.toJsonML(), this, obj);\n        } else {\n            this.text(\"\" + obj, ctx);\n        }\n    }\n\n}\n\nfunction jsonml2idom(jsonML: JsonML, ctx?: any): void {\n    jsonml(jsonML, new JsonmlIDomHandler(), ctx);\n}\n\n\nfunction jsonmls2idom(jsonMLs: JsonMLs, ctx?: any): void {\n    for (const jsonML of jsonMLs) {\n        if (jsonML.constructor === String) {\n            IncrementalDOM.text(jsonML);\n        } else if (\"toJsonML\" in (jsonML as any)) {\n            const obj = jsonML as JsonMLObj;\n            jsonml2idom(obj.toJsonML(), obj);\n        } else {\n            jsonml2idom(jsonML as JsonML, ctx);\n        }\n    }\n}\n\n\nexport function jsonml2idomPatch(node: Node, jsonML: JsonML, ctx?: any): void {\n    IncrementalDOM.patch(node,\n        (data: JsonML) => jsonml2idom(data, ctx), jsonML);\n}\n\nexport function jsonmls2idomPatch(node: Node, jsonMLs: JsonMLs, ctx?: any): void {\n    IncrementalDOM.patch(node,\n        (data: JsonMLs) => jsonmls2idom(data, ctx), jsonMLs);\n}\n","// Register Service Worker.\nexport function swInit(): void {\n    if (\"serviceWorker\" in navigator) {\n        // Path is relative to the origin, not project root.\n        navigator.serviceWorker.register(\"./sw.js\")\n            .then((registration) => {\n                // console.log(reg);\n                if (registration.installing) {\n                    console.log(\"Service worker installing\");\n                } else if (registration.waiting) {\n                    console.log(\"Service worker installed\");\n                } else if (registration.active) {\n                    console.log(\"Service worker active\");\n                }\n                console.log(\"Registration succeeded. Scope is \" + registration.scope);\n            })\n            .catch((error) => {\n                console.error(\"Registration failed with \" + error);\n            });\n    }\n}\n\nexport function showNotification(title: string, options?: NotificationOptions): void {\n    if ((self as any).Notification) {\n        console.log(\"Notification supported\");\n        Notification.requestPermission((result) => {\n            if (result === \"granted\") {\n                console.log(\"Notification permission granted\");\n                navigator.serviceWorker.ready.then((registration) => {\n                    console.log(\"Notification SW ready\");\n                    registration.showNotification(title, options);\n                });\n            } else {\n                console.warn(\"Notification permission:\", result);\n            }\n        });\n    } else {\n        console.warn(\"Notification not supported\");\n    }\n}\n","// declare const process: any;\n// const __NODE = Boolean(\n//     typeof process === \"object\" &&\n//     process.versions &&\n//     process.versions.node);\n\n// if (__NODE) {\n//     console.log(\"I'm running in Node.JS\");\n// } else {\n//     console.log(\"I'm running in browser\");\n// }\n\nimport { JsonML, JsonMLs, JsonMLObj } from \"./jsonml\";\nimport { jsonmls2idomPatch } from \"./jsonml-idom\";\n\n\nexport interface DomWidget {\n    mount(e: HTMLElement): this;\n    umount(): this;\n    onMount?(): void;\n    onUmount?(): void;\n}\n\nexport abstract class Widget implements JsonMLObj, DomWidget {\n\n    private static __count = 0;\n\n    readonly type: string = \"Widget\"; // this.constructor.name;\n    readonly id: string = this.type + \"-\" + Widget.__count++;\n    readonly dom: HTMLElement;\n    readonly refs: { [key: string]: HTMLElement } = {};\n\n    private _updateSched: number;\n\n    constructor(type: string = \"\") {\n        if (type) {\n            this.type = type;\n        }\n    }\n\n    abstract render(): JsonMLs;\n\n    mount(e: HTMLElement = document.body): this {\n        if (!this.dom) {\n            (this as any).dom = e;\n            const jsonMLs = (this as any).render();\n            jsonmls2idomPatch(e, jsonMLs, this);\n            e.setAttribute(\"widget\", this.type);\n            if ((this as any).onMount) {\n                (this as any).onMount();\n            }\n            // onDetach(e, () => {\n            //     (this as any).dom = undefined;\n            //     if ((this as any).onUmount) {\n            //         (this as any).onUmount();\n            //     }\n            // });\n        }\n        return this;\n    }\n\n    umount(): this {\n        if (this.dom) {\n            if ((this as any).onUmount) {\n                (this as any).onUmount();\n            }\n            if (this.dom.hasAttribute(\"widget\")) {\n                this.dom.removeAttribute(\"widget\");\n            }\n            this.dom.parentElement.removeChild(this.dom);\n            (this as any).dom = undefined;\n        }\n        return this;\n    }\n\n    update(): this {\n        if (this.dom && !this._updateSched) {\n            this._updateSched = setTimeout(() => {\n                if (this.dom) {\n                    jsonmls2idomPatch(this.dom, this.render(), this);\n                }\n                this._updateSched = null;\n            }, 0);\n        }\n        return this;\n    }\n\n    toJsonML(): JsonML {\n        if (this.dom) {\n            if (this._updateSched) {\n                clearTimeout(this._updateSched);\n                this._updateSched = null;\n            } else {\n                return [\n                    \"div\", {\n                        _skip: true,\n                        _id: this.id,\n                        _key: this.id,\n                        widget: this.type\n                    }\n                ];\n            }\n        }\n        const jsonMLs = (this as any).render();\n        return [\n            \"div\", {\n                _id: this.id,\n                _key: this.id,\n                widget: this.type\n            },\n            ...jsonMLs,\n            (e: HTMLElement) => {\n                if (!this.dom) {\n                    (this as any).dom = e;\n                    if ((this as any).onMount) {\n                        (this as any).onMount();\n                    }\n                    // onDetach(e, () => {\n                    //     (this as any).dom = undefined;\n                    //     if ((this as any).onUmount) {\n                    //         (this as any).onUmount();\n                    //     }\n                    // });\n                }\n            }\n        ];\n    }\n\n}\n\n// function onDetach(e: HTMLElement, callback: () => void) {\n//     new MutationObserver(mutations => {\n//         mutations.forEach(mutation => {\n//             const removed = mutation.removedNodes as any;\n//             for (const r of removed) {\n//                 console.log(r, r === e);\n//                 if (r === e) {\n//                     callback();\n//                 }\n//             }\n//         });\n//     }).observe(e.parentElement, { childList: true });\n//     // }).observe(e.parentElement, { childList: true, subtree: true });\n// }\n\n\n// const observer = new MutationObserver(mutations => {\n//     mutations.forEach(mutation => {\n//         // console.log(mutation.type);\n//         // console.log(mutation.target);\n//         // console.log(\"add\", mutation.addedNodes);\n//         // console.log(\"rm\", mutation.removedNodes);\n//         const added = mutation.addedNodes as any;\n//         for (const a of added) {\n//             console.log(\"added\", a);\n//         }\n//         const removed = mutation.removedNodes as any;\n//         for (const r of removed) {\n//             console.log(\"removed\", r);\n//         }\n//     });\n// });\n// const config = {\n//     childList: true,\n//     // attributes: true,\n//     // characterData: true,\n//     // subtree: true,\n//     // attributeOldValue: true,\n//     // characterDataOldValue: true,\n//     attributeFilter: [] as string[]\n// };\n// observer.observe(document.getElementById(\"app\"), config);\n// // observer.disconnect();\n\n\n// IncrementalDOM.notifications.nodesCreated = (nodes: Node[]) => {\n//     nodes.forEach(node => {\n//         // node may be an Element or a Text\n//         console.log(\"IncrementalDOM.notifications.nodesCreated\", node);\n//     });\n// };\n// IncrementalDOM.notifications.nodesDeleted = (nodes: Node[]) => {\n//     nodes.forEach(node => {\n//         // node may be an Element or a Text\n//         console.log(\"IncrementalDOM.notifications.nodesDeleted\", node);\n//     });\n// };\n","import { Widget } from \"./prest/jsonml/jsonml-widget\";\nimport { JsonMLs } from \"./prest/jsonml/jsonml\";\n\nimport { swInit, showNotification } from \"./sw-lib\";\n\n// declare const L: any;\nimport * as L from \"leaflet\";\n\n\nclass MapWidget extends Widget {\n\n    private _map: L.Map;\n    private _imagePath: string = \"lib/leaflet/images/\";\n\n    constructor() {\n        super(\"MapWidget\");\n    }\n\n    onMount() {\n        setTimeout(() => this._render(this.refs[\"map\"]), 0);\n    }\n\n    render(): JsonMLs {\n        return [\n            [\"div~map\", {\n                _skip: !!this._map,\n                // style: \"width: 100%; height: 100vw\" }\n                style: \"width: 100%; height: 100%\" }\n            ]\n        ];\n    }\n\n    private _render(element: HTMLElement): void {\n        if (this._imagePath) {\n            L.Icon.Default.imagePath = this._imagePath;\n        }\n\n        const map = L.map(element).fitWorld();\n        this._map = map;\n\n        L.tileLayer(\n            \"https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw\",\n            {\n                maxZoom: 18,\n                attribution:\n                    `Map data &copy; <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors, ` +\n                    `<a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, ` +\n                    `Imagery © <a href=\"http://mapbox.com\">Mapbox</a>`,\n                id: \"mapbox.streets\"\n            }\n        ).addTo(map);\n\n        map.on(\"locationfound\", this.onLocationFound);\n        map.on(\"locationerror\", this.onLocationError);\n\n        map.locate({ setView: true, maxZoom: 16 });\n    }\n\n    private onLocationFound = (e: L.LocationEvent) => {\n        const radius = e.accuracy / 2;\n        L.marker(e.latlng)\n            .addTo(this._map)\n            .bindPopup(\"<strong>Me</strong>, radius \" + radius + \"m\")\n            .openPopup();\n        L.circle(e.latlng, radius).addTo(this._map);\n    }\n\n    private onLocationError = (e: L.ErrorEvent) => {\n        alert(e.message);\n    }\n\n}\n\n\nswInit();\n\nconst app = new MapWidget();\napp.mount();\n\n\nsetTimeout(() => {\n    showNotification(\"Notif title\", {\n        body: \"Notif body\",\n        icon: \"assets/icons/ic-face.png\",\n        tag: \"notif-tag\"\n        // vibrate: [200, 100, 200, 100, 200, 100, 200],\n        // data: {\n        //     dateOfArrival: Date.now(),\n        //     primaryKey: 1\n        // },\n        // actions: [\n        //     {action: \"explore\", title: \"Explore this new world\",\n        //         icon: \"images/checkmark.png\"},\n        //     {action: \"close\", title: \"Close notification\",\n        //         icon: \"images/xmark.png\"},\n        // ]\n    });\n}, 3000);\n\n(self as any).app = app;\n\n(self as any).VERSION = \"@VERSION@\";\n"],"names":["jsonML","handler","ctx","head","attrsObj","hasAttrs","constructor","Object","childIdx","children","i","length","Function","attrs","refSplit","split","ref","dotSplit","hashSplit","tag","id","classes","slice","_id","_classes","_ref","open","l","jml","undefined","Array","jsonml","fnc","String","text","obj","close","JsonmlIDomHandler","jsonMLs","jsonMLs_1","_i","IncrementalDOM","jsonml2idom","toJsonML","node","patch","data","jsonmls2idom","title","options","self","Notification","console","log","requestPermission","result","navigator","serviceWorker","ready","then","registration","showNotification","warn","props","a","hasOwnProperty","concat","d","push","JSON","stringify","unshift","join","elementOpen","_key","_skip","skip","refs","currentElement","elementClose","this","type","Widget","__count","e","document","body","dom","jsonmls2idomPatch","render","setAttribute","onMount","onUmount","hasAttribute","removeAttribute","parentElement","removeChild","_updateSched","setTimeout","_this","widget","clearTimeout","_super","radius","accuracy","L.marker","latlng","addTo","_map","bindPopup","openPopup","L.circle","alert","message","__extends","MapWidget","_render","style","element","_imagePath","L.Icon","Default","imagePath","map","L.map","fitWorld","L.tileLayer","maxZoom","attribution","on","onLocationFound","onLocationError","locate","setView","register","installing","waiting","active","scope","catch","error","app","mount","icon","VERSION"],"mappings":"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"}